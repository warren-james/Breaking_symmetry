x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x)))
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x))) %>%
mutate(increase = as.factor(increase))
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x))) %>%
mutate(increase = as.factor(increase),
y = dbeta(x_vals, alpha, beta))
df_dists %>%
ggplot(aes(x_vals, y, colour = increase)) +
geom_line() +
facet_wrap(~Participant)
df_dists %>%
ggplot(aes(x_vals, y, colour = increase)) +
geom_line() +
facet_wrap(~Participant)
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x))) %>%
mutate(increase = as.factor(increase)) %>%
rowwise() %>%
mutate(y = dbeta(x_vals, alpha, beta))
rowwise() %>%
some
df_dists %>%
ggplot(aes(x_vals, y, colour = increase)) +
geom_line() +
facet_wrap(~Participant)
View(df_dists)
x_vals
# make some plots
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), length(x)),
beta = rep(unique(df_distributions$beta), length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(Participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
df_dists %>%
ggplot(aes(x_vals, y, colour = increase)) +
geom_line() +
facet_wrap(~Participant)
View(df_dists)
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), each = length(x)),
beta = rep(unique(df_distributions$beta), each = length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(Participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
df_dists %>%
ggplot(aes(x_vals, y, colour = increase)) +
geom_line() +
facet_wrap(~Participant)
head(df_part2)
head(df_dists)
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
binwidth = .1) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant)
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
binwidth = .1) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
binwidth = .1) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
plt_dists_wP <- df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(#aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
plt_dists_wP
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
x <- seq(0.0005,1-0.0005,0.0005)
# draw these
df_distributions <- tibble(x_vals = rep(x, length(c(0,mu2))),
base = mu1,
diff = rep(c(0,mu2), each = length(x)),
var = var1,
alpha = get_shape_beta(base + diff, var)$alpha,
beta = get_shape_beta(base + diff, var)$beta,
est_mu = mu_beta(alpha, beta),
est_var = var_beta(alpha, beta),
p = dbeta(x_vals, alpha, beta))
plt_both <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2,
y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
guides(colour = guide_legend("Difference")) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "bottom")
plt_dists <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
scale_x_continuous("standing position") +
guides(colour = guide_legend("Difference")) +
theme(
axis.title.y = element_blank(),
legend.title = element_blank(),
legend.position = "right"
)
plt_hist <- df_distributions %>%
filter(diff == 0) %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
see::scale_color_flat() +
theme_bw() +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2, y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
scale_x_continuous("standing position") +
theme(
legend.position = "none",
axis.title.y = element_blank()
)
gridExtra::grid.arrange(plt_hist, plt_dists, ncol = 2)
# Same as above but for each participant
# Need to sample each participant and get parameters for them
temp <- df_part2 %>%
group_by(Participant) %>%
summarise(a = fitdistrplus::fitdist(beta_pos, "beta")$estimate[1],
b = fitdistrplus::fitdist(beta_pos, "beta")$estimate[2])
mus <- seq(0, .2, .05)
df_distributions <- tibble(participant = rep(temp$Participant, each = length(mus)),
og_as = rep(temp$a, each = length(mus)),
og_bs = rep(temp$b, each = length(mus)),
og_mu = mu_beta(og_as, og_bs),
og_var = var_beta(og_as, og_bs),
increase = rep(mus, length(temp$a))) %>%
mutate(mu = og_mu + increase,
var = og_var,
alpha = get_shape_beta(mu, var)$alpha,
beta = get_shape_beta(mu, var)$beta) %>%
select(participant, increase, mu, var, alpha, beta)
# make some plots
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), each = length(x)),
beta = rep(unique(df_distributions$beta), each = length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(Participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
# make plot
plt_dists_wP <- df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
plt_dists_wP
max(x)
min(x)
x <- seq(0.05,1-0.05,0.05)
# draw these
df_distributions <- tibble(x_vals = rep(x, length(c(0,mu2))),
base = mu1,
diff = rep(c(0,mu2), each = length(x)),
var = var1,
alpha = get_shape_beta(base + diff, var)$alpha,
beta = get_shape_beta(base + diff, var)$beta,
est_mu = mu_beta(alpha, beta),
est_var = var_beta(alpha, beta),
p = dbeta(x_vals, alpha, beta))
plt_both <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2,
y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
guides(colour = guide_legend("Difference")) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "bottom")
plt_dists <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
scale_x_continuous("standing position") +
guides(colour = guide_legend("Difference")) +
theme(
axis.title.y = element_blank(),
legend.title = element_blank(),
legend.position = "right"
)
plt_hist <- df_distributions %>%
filter(diff == 0) %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
see::scale_color_flat() +
theme_bw() +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2, y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
scale_x_continuous("standing position") +
theme(
legend.position = "none",
axis.title.y = element_blank()
)
gridExtra::grid.arrange(plt_hist, plt_dists, ncol = 2)
# Same as above but for each participant
# Need to sample each participant and get parameters for them
temp <- df_part2 %>%
group_by(Participant) %>%
summarise(a = fitdistrplus::fitdist(beta_pos, "beta")$estimate[1],
b = fitdistrplus::fitdist(beta_pos, "beta")$estimate[2])
mus <- seq(0, .2, .05)
df_distributions <- tibble(participant = rep(temp$Participant, each = length(mus)),
og_as = rep(temp$a, each = length(mus)),
og_bs = rep(temp$b, each = length(mus)),
og_mu = mu_beta(og_as, og_bs),
og_var = var_beta(og_as, og_bs),
increase = rep(mus, length(temp$a))) %>%
mutate(mu = og_mu + increase,
var = og_var,
alpha = get_shape_beta(mu, var)$alpha,
beta = get_shape_beta(mu, var)$beta) %>%
select(participant, increase, mu, var, alpha, beta)
# make some plots
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), each = length(x)),
beta = rep(unique(df_distributions$beta), each = length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(Participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
# make plot
plt_dists_wP <- df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
plt_dists_wP
x <- seq(0.02,1-0.02,0.02)
# draw these
df_distributions <- tibble(x_vals = rep(x, length(c(0,mu2))),
base = mu1,
diff = rep(c(0,mu2), each = length(x)),
var = var1,
alpha = get_shape_beta(base + diff, var)$alpha,
beta = get_shape_beta(base + diff, var)$beta,
est_mu = mu_beta(alpha, beta),
est_var = var_beta(alpha, beta),
p = dbeta(x_vals, alpha, beta))
plt_both <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2,
y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
guides(colour = guide_legend("Difference")) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
legend.position = "bottom")
plt_dists <- df_distributions %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
theme_bw() +
see::scale_color_flat() +
scale_x_continuous("standing position") +
guides(colour = guide_legend("Difference")) +
theme(
axis.title.y = element_blank(),
legend.title = element_blank(),
legend.position = "right"
)
plt_hist <- df_distributions %>%
filter(diff == 0) %>%
mutate(diff = as.factor(diff)) %>%
ggplot(aes(x_vals, p)) +
geom_line(aes(colour = diff)) +
see::scale_color_flat() +
theme_bw() +
geom_histogram(data = df_part2,
aes(x = (norm_pos + 1)/2, y = ..density..),
binwidth = .1,
colour = "blue",
fill = "blue",
alpha = .2) +
scale_x_continuous("standing position") +
theme(
legend.position = "none",
axis.title.y = element_blank()
)
gridExtra::grid.arrange(plt_hist, plt_dists, ncol = 2)
# Same as above but for each participant
# Need to sample each participant and get parameters for them
temp <- df_part2 %>%
group_by(Participant) %>%
summarise(a = fitdistrplus::fitdist(beta_pos, "beta")$estimate[1],
b = fitdistrplus::fitdist(beta_pos, "beta")$estimate[2])
mus <- seq(0, .2, .05)
df_distributions <- tibble(participant = rep(temp$Participant, each = length(mus)),
og_as = rep(temp$a, each = length(mus)),
og_bs = rep(temp$b, each = length(mus)),
og_mu = mu_beta(og_as, og_bs),
og_var = var_beta(og_as, og_bs),
increase = rep(mus, length(temp$a))) %>%
mutate(mu = og_mu + increase,
var = og_var,
alpha = get_shape_beta(mu, var)$alpha,
beta = get_shape_beta(mu, var)$beta) %>%
select(participant, increase, mu, var, alpha, beta)
# make some plots
df_dists <- tibble(Participant = rep(unique(df_distributions$participant), each = length(x) * length(mus)),
x_vals = rep(x, length(mus) *length(unique(df_distributions$participant))),
increase = rep(rep(mus, each = length(x)), length(unique(df_distributions$participant))),
alpha = rep(unique(df_distributions$alpha), each = length(x)),
beta = rep(unique(df_distributions$beta), each = length(x))) %>%
mutate(increase = as.factor(increase)) %>%
group_by(Participant, increase, x_vals) %>%
mutate(y = dbeta(x_vals, alpha, beta))
# make plot
plt_dists_wP <- df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
facet_wrap(~Participant, scales = "free")
plt_dists_wP
plt_dists_wP <- df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
facet_wrap(~Participant, scales = "free")
plt_dists_wP
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(paste("Normalised", expression(Delta), sep = "")) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(expression(paste("Normalised", Delta, sep = ""))) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(expression(paste("Normalised", Delta, sep = " "))) +
theme_bw() +
theme(strip.text.x = element_blank()) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(expression(paste("Normalised", Delta, sep = " "))) +
theme_bw() +
theme(strip.text.x = element_blank()) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(expression(paste("Normalised", Delta, sep = "  "))) +
theme_bw() +
theme(strip.text.x = element_blank()) +
facet_wrap(~Participant, scales = "free")
df_part2 %>%
ggplot(aes(beta_pos)) +
geom_histogram(aes(y = ..density..),
# binwidth = .1
) +
geom_line(data = df_dists,
aes(x_vals, y,
colour = increase)) +
see::scale_color_flat() +
scale_x_continuous(expression(paste("Normalised ", Delta, sep = " "))) +
theme_bw() +
theme(strip.text.x = element_blank()) +
facet_wrap(~Participant, scales = "free")
install.packages("RWeiner")
install.packages("RWiener")
