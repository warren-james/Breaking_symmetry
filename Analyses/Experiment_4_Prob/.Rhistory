group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
gather(Predicted:Actual,
key = "Type",
value = "Proportion") %>%
ggplot(aes(Proportion,
colour = Type,
fill = Type)) +
# geom_density(alpha = .3) +
geom_histogram(position = "dodge") +
facet_grid(bias_type ~ dist_type)
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
gather(Predicted:Actual,
key = "Type",
value = "Proportion") %>%
ggplot(aes(Proportion,
colour = Type,
fill = Type)) +
geom_density(alpha = .3) +
# geom_histogram(position = "dodge") +
facet_grid(bias_type ~ dist_type)
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
ggplot(aes(participant, Proportion,
colour = bias_type)) +
geom_point(aes(y = Actual,
fill = bias_type),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~dist_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type)) +
geom_point(aes(y = Actual,
fill = dist_type),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
group_by(bias_type, dist_type) %>%
summarise(Actual = mean(Ml_fix))
df_model %>%
group_by(bias_type, dist_type) %>%
summarise(Actual = mean(Ml_fix)) %>%
rowwise() %>%
mutate(Predicted = predict(m_fix_like_sep.2, data.frame(bias_type = bias_type, dist_type = dist_type),
type = "response"))
df_model %>%
group_by(bias_type, dist_type) %>%
summarise(Predicted_mean = mean(p),
Actual_mean = mean(Ml_fix))
df_model %>%
group_by(bias_type, dist_type, participant) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
gather(Predicted:Actual,
key = "Type",
value = "Proportion") %>%
ggplot(aes(bias_type, Proportion,
colour = Type,
fill = Type)) +
geom_boxplot(alpha = .3) +
facet_wrap(~dist_type)
df_model %>%
group_by(bias_type, dist_type, participant) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
gather(Predicted:Actual,
key = "Type",
value = "Proportion") %>%
ggplot(aes(dist_type, Proportion,
colour = Type,
fill = Type)) +
geom_boxplot(alpha = .3) +
facet_wrap(~bias_type)
df_model %>%
group_by(bias_type, dist_type, participant) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix)) %>%
gather(Predicted:Actual,
key = "Type",
value = "Proportion") %>%
ggplot(aes(dist_type, Proportion,
colour = Type,
fill = Type)) +
geom_boxplot(alpha = .3) +
facet_wrap(~bias_type) +
theme_bw() +
scale_y_continuous(breaks = seq(0,1,.2)) +
see::scale_color_flat() +
see::scale_fill_flat()
summary(m_fix_like)
temp <- glmer(Ml_fix ~ (bias_type + dist_type)^2,)
temp <- glmer(Ml_fix ~ (bias_type + dist_type)^2, data = df_model, family = "binomial")
temp <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + (1|participant), data = df_model, family = "binomial")
summary(temp)
summary(m_fix_like_sep.2)
temp <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + (dist_type + dist_type * bias_type|participant), data = df_model, family = "binomial")
summary(temp)
rm(temp)
summary(m_fix_like_sep.2)
test <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + ((bias_type + dist_type)^2||participant),
data = df_model,
family = "binomial")
summary(test)
m_fix_like_sep.2 <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + (1 + (bias_type + dist_type)^2|participant),
data = df_model,
family = "binomial")
summary(m_fix_like_sep.2)
df_model <- df_part2_fixed %>%
# filter(separation != 640) %>% # remove furthest point for now
select(participant, dist_type, bias_type, separation, st_box, accuracy) %>%
mutate(Ml_fix = ifelse(st_box == "most likely", 1, 0),
C_fix = ifelse(st_box == "centre", 1, 0),
) # rescale separation to avoid
m_fix_like_sep.2 <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + ((bias_type + dist_type)^2|participant),
data = df_model,
family = "binomial")
summary(m_fix_like_sep.2)
df_model <- df_part2_fixed %>%
filter(separation != 640) %>% # remove furthest point for now
select(participant, dist_type, bias_type, separation, st_box, accuracy) %>%
mutate(Ml_fix = ifelse(st_box == "most likely", 1, 0),
C_fix = ifelse(st_box == "centre", 1, 0),
) # rescale separation to avoid
####
summary(m_fix_like_sep.2)
# fully random
m_fix_like_sep.2 <- glmer(Ml_fix ~ (bias_type + dist_type)^2 + ((bias_type + dist_type)^2|participant),
data = df_model,
family = "binomial")
summary(m_fix_like_sep.2)
summary(m_fix_like_sep.2)$Fixed
temp <- summary(m_fix_like_sep.2)
head(temp)
rm(test)
temp$coefficients
fixef(m_fix_like_sep.2)
??predict
df_model$p_fe <- predict(m_fix_like_sep.2, re.form = NULL, type = "response")
View(df_model)
df_model$p_fe <- predict(m_fix_like_sep.2, re.form = NA, type = "response")
View(df_model)
df_model$p = predict(m_fix_like_sep.2, type = "response")
df_model$p_fe = predict(m_fix_like_sep.2, re.form = NA, type = "response")
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(yintercept = FE) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe))
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE)) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE,
colour = dist_type)) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe),
med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = med_FE,
colour = dist_type)) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>%
mutate(med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = med_FE,
colour = dist_type)) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>%
mutate(med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE,
colour = dist_type),
linetype = "dashed") +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
View(df_model)
??lmer
rm(temp)
m_fix_like_sep.3 <- glmer(Ml_fix ~ (bias_type + dist_type)^2 +
(1|participant) +
(bias_type - 1|participant) +
(dist_type - 1|participant),
data = df_model,
family = "binomial")
summary(m_fix_like_sep.3)
df_model$p = predict(m_fix_like_sep.2, type = "response")
df_model$p_fe = predict(m_fix_like_sep.2, re.form = NA, type = "response")
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>%
mutate(med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE,
colour = dist_type),
linetype = "dashed") +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model$p = predict(m_fix_like_sep.3, type = "response")
df_model$p_fe = predict(m_fix_like_sep.3, re.form = NA, type = "response")
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>%
mutate(med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE,
colour = dist_type),
linetype = "dashed") +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
summary(m_fix_like_sep.2)
summary(m_fix_like_sep.3)
bm_fix_like_dt <- brm(Ml_fix ~ (bias_type + dist_type)^2 + (dist_type + bias_type|participant),
data = df_model,
family = "bernoulli",
chains = 1,
iter = 1000,
warmup = 500)
summary(bm_fix_like_dt)
df_model$p_b <- predict(bm_fix_like_dt, type = "response")
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p_bm),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>% %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p_bm),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
head(df_model)
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p_b.Estimate),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p_b.Estimate),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model$p_b
df_model$p_b[1]
df_model$p_b[1,]
df_model$p_b[,1]
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p_b[,1]),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
df_model$p = predict(m_fix_like_sep.3, type = "response")
df_model$p_fe = predict(m_fix_like_sep.3, re.form = NA, type = "response")
df_model %>%
mutate(participant = as.factor(as.numeric(participant))) %>%
group_by(participant, bias_type, dist_type) %>%
summarise(Predicted = mean(p),
Actual = mean(Ml_fix),
FE = mean(p_fe)) %>%
ungroup() %>%
group_by(bias_type, dist_type) %>%
mutate(med_FE = median(Predicted)) %>%
ggplot(aes(participant, Proportion,
colour = dist_type,
fill = dist_type)) +
geom_point(aes(y = Actual),
shape = 21) +
geom_point(aes(y = Predicted),
fill = "white",
shape = 21) +
geom_hline(aes(yintercept = FE,
colour = dist_type),
linetype = "dashed") +
facet_wrap(~bias_type) +
see::scale_color_flat() +
see::scale_fill_flat() +
theme_bw()
rm(list = ls())
