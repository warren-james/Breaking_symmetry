# Accuracy data
# Standing positions
# Total earnings
#### Library ####
library(tidyverse)
# library(rstan)
library(gridExtra)
library(forcats)
library(ggthemes)
#### Constants ####
slab_size <- 0.46
#### load in data ####
load("scratch/data/df_part2")
load("scratch/data/df_part1")
# relevel factors
#### Summaries and Plotting ####
# proportion of equal vs unequal
plt_prop_gamble_types <- df_part2 %>%
mutate(Participant = as.factor(as.numeric(Participant))) %>%
group_by(Participant, Gamble_Type) %>%
summarise(n = n()) %>%
ggplot(aes(Participant, n, fill = Gamble_Type)) +
scale_fill_ptol() +
geom_bar(stat = "identity", width = 0.5) +
theme_bw() +
scale_y_discrete(limits = seq(0,12,2)) +
theme(legend.position = "bottom")
plt_prop_gamble_types$labels$y <- "No. of each split"
plt_prop_gamble_types$labels$fill <- "Split"
plt_prop_gamble_types
# probably want to save these as well
# add that in later
# choices made
plt_standing_pos <- df_part2 %>%
mutate(Participant = as.factor(as.numeric(Participant))) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Gamble_Type)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
facet_wrap(~Participant, ncol = 4) +
theme(legend.position = "bottom",
strip.text.x = element_text(margin = margin(0.01,0,0.01,0, "mm")))
plt_standing_pos$labels$x <- "Delta (Metres)"
plt_standing_pos$labels$y <- "Nomalised Standing Position"
plt_standing_pos$labels$colour <- "Split"
plt_standing_pos
# plot together
grid.arrange(plt_prop_gamble_types,plt_standing_pos, ncol = 2)
plt_together <- arrangeGrob(plt_prop_gamble_types, plt_standing_pos, ncol = 2)
prop_split <- plt_prop_gamble_types[["data"]] %>%
ungroup() %>%
select(-.group) %>%
spread(Gamble_Type, n) %>%
replace_na(list(Equal = 0, Unequal = 0)) %>%
mutate(Equal = Equal/(Equal + Unequal),
Unequal = 1 - Equal,
order = Equal,
HoopDelta = 21) %>%
gather(Equal:Unequal,
key = "Split",
value = "prop")
plt_combined <- plt_standing_pos +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat()
plt_combined
plt_standing_pos[["data"]]
plt_combined <- plt_standing_pos[["data"]]
head(plt_combined)
head(prop_split)
plt_prop_gamble_types[["data"]] %>%
ungroup() %>%
select(-.group) %>%
spread(Gamble_Type, n) %>%
replace_na(list(Equal = 0, Unequal = 0)) %>%
mutate(Equal = Equal/(Equal + Unequal),
Unequal = 1 - Equal,
order = as.numeric(as.factor(Equal)),
HoopDelta = 21) %>%
gather(Equal:Unequal,
key = "Split",
value = "prop")
prop_split <- plt_prop_gamble_types[["data"]] %>%
ungroup() %>%
select(-.group) %>%
spread(Gamble_Type, n) %>%
replace_na(list(Equal = 0, Unequal = 0)) %>%
mutate(Equal = Equal/(Equal + Unequal),
Unequal = 1 - Equal,
order = as.numeric(as.factor(Equal)),
HoopDelta = 21) %>%
gather(Equal:Unequal,
key = "Split",
value = "prop")
View(prop_split)
temp_order <- prop_split %>%
group_by(participant) %>%
summarise(order = unique(order))
temp_order <- prop_split %>%
group_by(Participant) %>%
summarise(order = unique(order))
head(temp_order)
plt_combined <- plt_standing_pos[["data"]] %>%
merge(temp_order)
View(plt_combined)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Gamble_Type)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Gamble_Type)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type)
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
alpha = .5)
# colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split,
alpha = .5),
# colour = Split),
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter() +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 1,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_combined <- plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_combined
prop_split <- plt_prop_gamble_types[["data"]] %>%
ungroup() %>%
select(-.group) %>%
spread(Gamble_Type, n) %>%
replace_na(list(Equal = 0, Unequal = 0)) %>%
mutate(Equal = Equal/(Equal + Unequal),
Unequal = 1 - Equal,
order = as.numeric(as.factor(Equal)),
HoopDelta = 24) %>%
gather(Equal:Unequal,
key = "Split",
value = "prop")
# get order data
temp_order <- prop_split %>%
group_by(Participant) %>%
summarise(order = unique(order))
plt_combined <- plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
facet_wrap(~ order + Participant)
plt_combined
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
lables = c(seq(0,20,5), "Ratio"))
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
lables = c(seq(0,20,5), "Ratio")) +
facet_wrap(~ order + Participant)
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
labels = c(seq(0,20,5), "Ratio")) +
facet_wrap(~ order + Participant)
prop_split <- plt_prop_gamble_types[["data"]] %>%
ungroup() %>%
select(-.group) %>%
spread(Gamble_Type, n) %>%
replace_na(list(Equal = 0, Unequal = 0)) %>%
mutate(Equal = Equal/(Equal + Unequal),
Unequal = 1 - Equal,
order = as.numeric(as.factor(Equal)),
HoopDelta = 25) %>%
gather(Equal:Unequal,
key = "Split",
value = "prop")
# get order data
temp_order <- prop_split %>%
group_by(Participant) %>%
summarise(order = unique(order))
plt_combined <- plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
theme_bw() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
labels = c(seq(0,20,5), "Ratio")) +
facet_wrap(~ order + Participant)
plt_combined
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
# theme_bw() +
see::theme_abyss() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
labels = c(seq(0,20,5), "Ratio")) +
facet_wrap(~ order + Participant)
plt_combined
plt_standing_pos[["data"]] %>%
merge(temp_order) %>%
mutate(Split = Gamble_Type) %>%
filter(Norm_Dist <= 1) %>%
ggplot(aes(HoopDelta, Norm_Dist, colour = Split)) +
scale_colour_ptol() +
geom_jitter(alpha = .5) +
# theme_bw() +
see::theme_abyss() +
theme(strip.text.x = element_blank()) +
geom_bar(data = prop_split,
aes(HoopDelta, prop,
fill = Split),
# colour = Split),
width = 2,
colour = "black",
alpha = .5,
stat = "identity") +
see::scale_color_flat() +
see::scale_fill_flat() +
scale_x_continuous(breaks = seq(0, 25, 5),
labels = c(seq(0,20,5), "Ratio")) +
facet_wrap(~ order + Participant)
head(df_part2)
df_part2 %>% mutate(outside = ifelse(Norm_Dist > 1, 1, 0)) %>% group_by(outside) %>% summarise(n = n()
)
7/(233+7)
(7/(233+7))*100
df_part2 %>% mutate(outside = ifelse(Norm_Dist >= 1, 1, 0)) %>% group_by(outside) %>% summarise(n = n()
)
df_part2 %>% mutate(outside = ifelse(Norm_Dist > 1, 1, 0)) %>% group_by(outside) %>% summarise(n = n()
)
